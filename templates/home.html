{% extends 'base.html' %}

{% load static %}

{% block title %} Welcome | {% endblock %}

{% block head_extras %}
    <link rel='stylesheet' href='https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css'>

    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

    <script src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
    <script src='//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js'></script>

    <link href="{% static 'fontawesomefree/css/fontawesome.css' %}" rel="stylesheet" type="text/css">
    <link href="{% static 'fontawesomefree/css/all.min.css' %}" rel="stylesheet" type="text/css">
    <link href="{% static 'fontawesomefree/css/solid.css' %}" rel="stylesheet" type="text/css">

    <script>
        function DateDisable() {
            var dtToday = new Date();

            var month = dtToday.getMonth() + 1;
            var day = dtToday.getDate() + 1;
            var year = dtToday.getFullYear ();
            if(month < 10)
                month = '0' + month.toString();
            if(day < 10)
                day = '0' + day.toString();


            var maxDate = year + '-' + month + '-' + day;

            $('#dateControl').attr('min', maxDate);
        }
    </script>


    <script>
        $( function() {
            $("#slider-range").slider({
                range: true,
                min: 480,
                max: 1080,
                step: 30,
                values: [480, 1080],
                slide: function (e, ui) {
                    var hours1 = Math.floor(ui.values[0] / 60);
                    var minutes1 = ui.values[0] - (hours1 * 60);
    
                    if (hours1.length == 1) hours1 = '0' + hours1;
                    if (minutes1.length == 1) minutes1 = '0' + minutes1;
                    if (minutes1 == 0) minutes1 = '00';
                    if (hours1 >= 12) {
                        if (hours1 == 12) {
                            hours1 = hours1;
                            minutes1 = minutes1 + " PM";
                        } else {
                            hours1 = hours1 - 12;
                            minutes1 = minutes1 + " PM";
                        }
                    } else {
                        hours1 = hours1;
                        minutes1 = minutes1 + " AM";
                    }
                    if (hours1 == 0) {
                        hours1 = 12;
                        minutes1 = minutes1;
                    }
    
                    var from_time = document.getElementById("from_time")
    
                    from_time.value = hours1 + ':' + minutes1;
                    // $('.from_time').html(hours1 + ':' + minutes1);
    
                    var hours2 = Math.floor(ui.values[1] / 60);
                    var minutes2 = ui.values[1] - (hours2 * 60);
    
                    if (hours2.length == 1) hours2 = '0' + hours2;
                    if (minutes2.length == 1) minutes2 = '0' + minutes2;
                    if (minutes2 == 0) minutes2 = '00';
                    if (hours2 >= 12) {
                        if (hours2 == 12) {
                            hours2 = hours2;
                            minutes2 = minutes2 + " PM";
                        } else if (hours2 == 24) {
                            hours2 = 11;
                            minutes2 = "59 PM";
                        } else {
                            hours2 = hours2 - 12;
                            minutes2 = minutes2 + " PM";
                        }
                    } else {
                        hours2 = hours2;
                        minutes2 = minutes2 + " AM";
                    }
                    
                    var to_time = document.getElementById("to_time")

                    to_time.value = hours2 + ':' + minutes2;

                    // $('.to_time').html(hours2 + ':' + minutes2);
                }
            })
            var to_time = document.getElementById("to_time").value

            // const tot = to_time.value
            console.log(to_time)

            const [actualTime, dayornight] = to_time.split(' ')
            // console.log(actualTime)
            const timestamp = actualTime.getTime()
            console.log(timestamp)
        } );
    </script>

    <script>

        var to_time = document.getElementById("to_time").value;

        
        // const tot = to_time.value
        console.log(to_time)

        const [actualTime, dayornight] = tot.split(' ');
        console.log(actualTime)
        const timestamp = actualTime.getTime();
        console.log(timestamp)
    </script>

    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBsRtR6J_NowzIITNDGs0QzIn9M_mSVyDs&libraries=places"></script>

    <!-- <script type="text/javascript"
              src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBsRtR6J_NowzIITNDGs0QzIn9M_mSVyDs"></>
      <script src="https://unpkg.com/location-picker/dist/location-picker.min.js"></script> -->


    <style type="text/css">
        #map {
        width: 80%;
        height: 45px;
        }
        /* #autocomplete {
        height: 30px;
        padding-left: 10px;
        border-radius: 4px;
        border: 1px solid rgb(186, 178, 178);
        box-shadow: 0px 0px 12px #EFEFEF;
        } */
    </style>

{% endblock %}


{% block content %}

  


<div class="pt-10 pb-5 lg:pt-20 lg:pb-10 text-center">
    <h1 class="text-3xl lg:text-5xl primaryColorText">Book a Ride</h1>
</div>

<div class="card p-3" style="border-radius: 1rem;">
    
    <form method="post">
        {% csrf_token %}

        <div class="row">
            <div class="col-6">
                <label for="basic-url" class="form-label">Name:</label>
                <div class="input-group mb-3">
                    <span class="input-group-text" id="basic-addon3"><i class="fa-solid fa-user"></i></span>
                    <input type="text" class="form-control" name="username" placeholder="Name">
                </div>
            </div>

            
            <div class="col-3">
                <label for="basic-url" class="form-label">Option:</label>
                <select class="form-select" aria-label="Default select example">
                    <option selected disabled>Choose option..</option>
                    {% for option in options %}
                        <option value="{{option.CB_For_Id}}">{{option.CB_For}}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="col-3">
                <label for="basic-url" class="form-label">Booking Date:</label>
                <div class="input-group mb-3"  onclick="DateDisable()">
                    <span class="input-group-text" id="basic-addon3"><i class="fa-solid fa-calendar-days"></i></span>
                    <input type="date" class="form-control" name="booking_date" id="dateControl" aria-describedby="basic-addon3">
                </div>
            </div>

        </div>

        <br/>
        <hr/>
        <br/>

        <div class="row align-items-center justify-content-center" id="time-range">
            <div class="col-xl-2 col-lg-3 col-md-4 col-4">
                <label for="basic-url" class="form-label">From:</label>
                <div class="input-group mb-3">
                    <span class="input-group-text" id="basic-addon3"><i class="fa-solid fa-clock"></i></span>
                    <input type="text" class="form-control text-center" name="from_time" id="from_time" value="8:00 AM">
                    <!-- <label class="form-control from_time text-center" name="from_time" id="from_time">8:00 AM</label> -->
                </div>
            </div>

            <div class="col-xl-2 col-lg-3 col-md-4 col-4">
                <label for="basic-url" class="form-label">To:</label>
                <div class="input-group mb-3">
                    <span class="input-group-text" id="basic-addon3"><i class="fa-solid fa-clock"></i></span>
                    <input type="text" class="form-control text-center" name="to_time" id="to_time" value="6:00 PM">
                    <!-- <label class="form-control to_time text-center" name="to_time" id="to_time">6:00 PM</label> -->
                </div>
            </div>

            <div class="col-8 mt-3">
                <div class="sliders_step1 col-12">
                    <div id="slider-range"></div>
                </div>
            </div>
        </div>

        <div class="row align-items-center">
            <div class="col-6">
                <label for="basic-url" class="form-label">Enter Pickup:</label>
                <div class="input-group mb-3">
                    <span class="input-group-text" id="basic-addon3"><i class="fa-solid fa-location-dot"></i></span>
                    <input type="text" name="Source" id="Source" class="form-control primaryColorText"/>
                </div>
            </div>

            <div class="col-6">
                <label for="basic-url" class="form-label">Enter Destination:</label>
                <div class="input-group mb-3">
                    <span class="input-group-text" id="basic-addon3"><i class="fa-solid fa-location-dot"></i></span>
                    <input type="text" name="Destination" id="Destination" class="form-control primaryColorText"/>
                </div>
            </div>
        </div>

        <br/>
        <hr/>
        <br/>

        <div class="row">
            <div class="col-3">
                <label for="basic-url" class="form-label">No of Passengers:</label>
                <div class="input-group mb-3">
                    <span class="input-group-text" id="basic-addon3"><i class="fa-solid fa-people-group"></i></span>
                    <input type="number" name="No_Of_Passenger" id="No_Of_Passenger" class="form-control primaryColorText" placeholder="Passenger Count"/>
                </div>
            </div>

            <div class="col-9">
                <label for="basic-url" class="form-label">Purpose:</label>
                <div class="input-group mb-3">
                    <span class="input-group-text" id="basic-addon3"><i class="fa-solid fa-comment"></i></span>
                    <textarea name="Purpose" id="Purpose" class="form-control primaryColorText" placeholder="Enter your Purpose of Booking"></textarea>
                </div>
            </div>
        </div>

        <!-- <div class="row">
            <div class="col-4">
                <label for="basic-url" class="form-label">Enter Destination:</label>
                <div class="input-group mb-3">
                    <span class="input-group-text" id="basic-addon3"><i class="fa-solid fa-location-dot"></i></span>
                    <input type="text" id="autocomplete" class="form-control primaryColorText"/>
                </div>
            </div>
        </div> -->
        
        <!-- <div id="map"></div>
        <br>
        <button id="confirmPosition">Confirm Position</button>
        <br>
        <p>On idle position: <span id="onIdlePositionView"></span></p>
        <p>On click position: <span id="onClickPositionView"></span></p> -->

        <!-- <div class="col-6 align-items-center justify-content-center"> -->
            

            <!-- <div class="col-5">
                <button type="button" class="btn btn-info text-dark col-3" data-bs-toggle="modal" data-bs-target="#exampleModal">
                    Choose Location
                </button>
            </div>
            
            <div class="modal fade text-black" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered modal-fullscreen-sm-down">
                    <div class="modal-content">
                        <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <input type="text" id="autocomplete" class="primaryColorText"/>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                    </div>
                </div>
            </div> -->

        <br/>

        <center>
            <button class="btn btn-outline-success btn-lg px-11 mt-12 py-3" type="submit">Book</button>
        </center>

    </form>


<!-- <div class="form-group row">
    <input type="hidden" id="latitude" name="latitude"/>
    <input type="hidden" id="longitude" name="longitude"/>

    <div class="col-sm-1"></div>

    <label class="form-control label col-sm-4">Location</label>

    <div class="col-sm-1">
        <a class="btn btn-info" onclick="initModal()">Choose Location</a>
    </div>
</div> -->


<!-- <div id="google_map" style="width:800px;height:400px;"></div>

</div> -->




{% block scripts %}

    <script>
        var source = document.getElementById('Source');
        var destination = document.getElementById('Destination');
        var sourceLocation = new google.maps.places.Autocomplete(source);
        var destinationLocation = new google.maps.places.Autocomplete(destination);
    </script>

    <!-- <script>
    // Get element references
    var confirmBtn = document.getElementById('confirmPosition');
    var onClickPositionView = document.getElementById('onClickPositionView');
    var onIdlePositionView = document.getElementById('onIdlePositionView');
  
    // Initialize locationPicker plugin
    var lp = new locationPicker('map', {
      setCurrentPosition: true, // You can omit this, defaults to true
    }, {
      zoom: 15 // You can set any google map options here, zoom defaults to 15
    });
  
    // Listen to button onclick event
    confirmBtn.onclick = function () {
      // Get current location and show it in HTML
      var location = lp.getMarkerPosition();
      onClickPositionView.innerHTML = 'The chosen location is ' + location.lat + ',' + location.lng;
    };
  
    // Listen to map idle event, listening to idle event more accurate than listening to ondrag event
    google.maps.event.addListener(lp.map, 'idle', function (event) {
      // Get current location and show it in HTML
      var location = lp.getMarkerPosition();
      onIdlePositionView.innerHTML = 'The chosen location is ' + location.lat + ',' + location.lng;
    });
  </script>-->


{% endblock %}


{% endblock %}